@model KOP.WEB.Models.ViewModels.Analytics.AnalyticsLayoutViewModel

@{
	Layout = "/Views/Shared/_Layout.cshtml";
}

<div class="home-content">
	<div class="home_content_info">
		<div class="home_content_info_icon">
			<i class="fa-solid fa-folder"></i>
		</div>
		<div class="mid_title">
			Аналитика и витрина данных
		</div>
	</div>
</div>

<div id="assessmentAnalytics">
</div>

<div class="main_container_content ">
	<div class="custom-select-politics">
		<div class="select-box-politics">
			@if (Model.SubordinateUsers.Any())
			{
				<span class="select-label-politics">@Model.SubordinateUsers.First().FullName</span>
			}
			else
			{
				<span class="select-label-politics">Нет пользователей</span>
			}
			<span class="select-arrow-politics"><img src="/image/chevron-down-grey.svg" alt=""></span>
		</div>
		<div class="select-options-politics">
			@if (Model.SubordinateUsers.Any())
			{
				foreach (var user in Model.SubordinateUsers)
				{
					<div class="option-politics" data-id="@user.Id">
						<span class="icon-politics">@user.FullName</span>
					</div>
				}
			}
			else
			{
				<div class="option-politics">
					<span class="icon-politics">Нет пользователей</span>
				</div>
			}
		</div>
	</div>
	<div class="dashboard-container">
		<div class="dashboard-item active-challenges">
			<div class="header-wrapper">
				<div class="description">
					ОЦЕНКА КОМПЕТЕНЦИЙ
				</div>
				<div>
					<div id="generalAvgValue"></div>
					<div id="selfAvgValue"></div>
					<div id="supervisorAvgValue"></div>
					<div id="colleaguesAvgValue"></div>
				</div>
				<div class="header-btns-wrapper">
					<button class="expand-btn" data-target="chart4"><i class="fa-solid fa-expand" style="color: #b5b5c2;"></i></button>
				</div>
			</div>
			<div id="tabContainer"></div>
			<canvas id="chart4" data-modal="chart4Modal"></canvas>
			<div id="emptyImage"></div>
		</div>
		<div class="dashboard-item active-challenges">
			<div>
				ТОП-5 КОМПЕТЕНЦИЙ
				<div id="topCompetencies">
				</div>
			</div>
			<div>
				АНТИТОП-5 КОМПЕТЕНЦИЙ
				<div id="antiTopCompetencies">
				</div>
			</div>
			<div>
				ПРОФЕССИОНАЛЬНОЕ ПОВЕДЕНИЕ
				<div id="topDescriptions">
				</div>
			</div>
			<div>
				НЕПРОФЕССИОНАЛЬНОЕ ПОВЕДЕНИЕ
				<div id="antiTopDescriptions">
				</div>
			</div>
		</div>
		<div id="chartModal" class="modal">
			<span class="close"><i class="fa-solid fa-xmark" style="color: #ffffff;"></i></span>
			<div class="modal-content">
				<canvas id="modalChart"></canvas>
			</div>
		</div>
	</div>
</div>

<script src="/js/analyticsScript.js"></script>

<script>
	// Проверка наличия пользователей и вызов функции с ID первого пользователя
	@if (Model.SubordinateUsers.Any())
	{
		<text>
							loadAssessmentAnalytics('@Model.SubordinateUsers.First().Id');
									loadCompetenciesAnalytics('@Model.SubordinateUsers.First().Id');
		</text>
	}
	else
	{
		<text>
						displayNoDataMessage()
		</text>
	}
</script>

<style>
	.tab-container {
		display: flex;
		border-bottom: 1px solid #ccc;
	}

	.tab {
		padding: 10px 20px;
		cursor: pointer;
		background: none;
		border: none;
		outline: none;
	}

		.tab.active {
			font-weight: bold;
			border-bottom: 2px solid #007bff; /* Цвет активной вкладки */
		}

	.content-container {
		padding: 20px;
	}
</style>